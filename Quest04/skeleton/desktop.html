<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="./desktop.css">
	<script src="./desktop.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
	<!--sweetalert2-->
	<title>ğŸ’»</title>
</head>

<body>
	<section class="desktop"></section>

	<script>
		/** ë³€ìˆ˜ **/
		let body = document.getElementsByTagName('body')[0];
		let desktop = document.querySelector('.desktop');

		desktop.draggable = true; // ë“œë˜ê·¸ í—ˆìš©

		/** ëª¨ë‹¬ **/
		let modal = document.createElement('div')
		let modalBody = document.createElement('div');
		let closeBtn = document.createElement('button');



		let iconCheck;
		let folderCheck;
		let iconNum; // ì…ë ¥ë°›ì€ icon ê°œìˆ˜
		let folderNum; // ì…ë ¥ë°›ì€ folder ê°œìˆ˜

		/** ì´ˆê¸° í™”ë©´ **/
		function checkPrompt(typeNum, name) {
			typeNum = Number(prompt('ìƒì„±í•  ' + name + 'ì˜ ê°œìˆ˜ë¥¼ ì…ë ¥í•˜ì‹œì˜¤'));
			return typeNum;
		}

		function checkFolder() {
			folderCheck = confirm('í´ë”ë¥¼ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
			if (folderCheck) {
				folderNum = checkPrompt(folderNum, 'í´ë”');
				if (folderNum < 1) {
					folderNum = checkPrompt(folderNum, 'í´ë”');
				}
			}
		}

		/** ì‹¤í–‰ **/
		iconCheck = confirm('ì•„ì´ì½˜ì„ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
		if (iconCheck) {
			iconNum = checkPrompt(iconNum, 'ì•„ì´ì½˜');
			if (iconNum < 1) {
				iconNum = checkPrompt(iconNum, 'ì•„ì´ì½˜');
			} else {
				checkFolder();
			}
		} else {
			checkFolder();
		}

		console.log('ì•„ì´ì½˜ ê°œìˆ˜>>', iconNum);
		console.log('í´ë” ê°œìˆ˜ >>', folderNum);


		icon = [];
		folder = [];

		// /** ì•„ì´ì½˜ ìƒì„±**/
		// for(var i = 0; i < iconNum;i++){
		// 	icon[i] = new Image();
		// 	icon[i].src = '.icon/icon.png';
		// 	icon[i].alt = 'icon'+ (i+1);
		// 	desktop.appendChild(icon[i]);
		// 	icon[i].className = 'icon';
		// }
		// /** í´ë” ìƒì„± **/
		// for(var i = 0; i < folderNum;i++){
		// 	folder[i] = new Image();
		// 	folder[i].src = '.icon/folder.png';
		// 	folder[i].alt = 'folder'+ (i+1);
		// 	desktop.appendChild(folder[i]);
		// 	folder[i].className = 'folder';
		// }


		function create(type, num, name) {
			for (var i = 0; i < num; i++) {
				type[i] = new Image();
				type[i].src = './icon/' + name + '.png';
				type[i].alt = name + (i + 1);
				desktop.appendChild(type[i]);
				type[i].className = name;
			}
		}

		create(icon, iconNum, 'icon');
		create(folder, folderNum, 'folder');




		/** ì¶”ê°€ ìƒì„± ë³€ìˆ˜ **/
		let img = desktop.getElementsByTagName('img');
		let folders = document.getElementsByClassName('folder');
		console.log(img); // HTMLCollection
		console.log(folders); // HTMLCollection

		let imgArr = [];
		let folderArr = [];

		imgArr = [].slice.call(img); // HTMLCollection -> array
		folderArr = [].slice.call(folders); // HTMLCollection -> array
		console.log(imgArr);
		console.log(folderArr);

		// // ëª¨ë‹¬
		modal.className = 'modal';
		modalBody.className = 'modal_body';
		modalBody.textContent = 'hello :D'
		closeBtn.className = 'close_btn';
		closeBtn.textContent = "X";
		body.appendChild(modal);
		modal.appendChild(modalBody);
		modalBody.appendChild(closeBtn);

		// ë”ë¸”í´ë¦­
		function dblclick(array) {
			array.forEach(function (c) {
				//í´ë” ë”ë¸”í´ë¦­ ì‹œ ëª¨ë‹¬ ì‘ë™!!!
				c.addEventListener('dblclick', function () {// ë”ë¸”í´ë¦­
					console.log('ë”ë¸”í´ë¦­');
					modal.classList.toggle('show');
					if (modal.classList.contains('show')) {
						body.style.overflow = 'hidden';
					}
				})
			})
		}
		closeBtn.addEventListener('click', function(){ // ë‹«ê¸° ë²„íŠ¼ ëˆ„ë¥´ë©´ í™”ë©´ ì‚¬ë¼ì§
			modal.classList.toggle('show');
			console.log('ëª¨ë‹¬ì°½ ë‹«ìŒ')
		})

		dblclick(folderArr);

		// function drag(array) {
		// 	array.forEach(function (d) {
		// 		d.addEventListener('dragstart', function () {
		// 			console.log('ë“œë˜ê·¸')
		// 		})
		// 	})
		// }
		// ë“œë˜ê·¸
		var active = false;
		var currentX;
		var currentY;
		var initialX;
		var initialY;
		var xOffset = 0;
		var yOffset = 0;

		// drag(imgArr);
		imgArr.forEach(function (d) {
			d.addEventListener("touchstart", dragStart, false);
			d.addEventListener("touchend", dragEnd, false);
			d.addEventListener("touchmove", drag, false);

			d.addEventListener("mousedown", dragStart, false);
			d.addEventListener("mouseup", dragEnd, false);
			d.addEventListener("mousemove", drag, false);

			function dragStart(e) {
				if (e.type === "touchstart") {
					initialX = e.touches[0].clientX - xOffset;
					initialY = e.touches[0].clientY - yOffset;
				} else {
					initialX = e.clientX - xOffset;
					initialY = e.clientY - yOffset;
				}

				if (e.target === d) {
					active = true;
				}
			}

			function dragEnd(e) {
				initialX = currentX;
				initialY = currentY;

				active = false;
			}

			function drag(e) {
				if (active) {

					e.preventDefault();

					if (e.type === "touchmove") {
						currentX = e.touches[0].clientX - initialX;
						currentY = e.touches[0].clientY - initialY;
					} else {
						currentX = e.clientX - initialX;
						currentY = e.clientY - initialY;
					}

					xOffset = currentX;
					yOffset = currentY;

					setTranslate(currentX, currentY, d);
				}
			}

			function setTranslate(xPos, yPos, el) {
				el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
			}
		})



















		// let conIcon = confirm('ì•„ì´ì½˜ì„ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');

		/** ì¶”ê°€ ìƒì„±**/
		// ì˜ì—­
		// bodyTop.className = 'top';
		// desktop.appendChild(bodyTop);
		// space.className = 'space';
		// desktop.appendChild(space);

		/** ë²„íŠ¼ **/
		// ì•„ì´ì½˜ ìƒì„±
		// cIconBtn.className = 'create_btn';
		// cIconBtn.textContent = 'ì•„ì´ì½˜ ìƒì„±';
		// bodyTop.appendChild(cIconBtn);

		// í´ë”ìƒì„±
		// cFolderBtn.className = 'create_btn';
		// cFolderBtn.textContent = 'í´ë” ìƒì„±';
		// bodyTop.appendChild(cFolderBtn);

		// let icon = []
		// let iconNum = 0;
		// let folder = [];
		// let folderNum = 0;

		// function creat(btnName, typeName, type, typeNum) {
		// 	btnName.addEventListener('click', function () {
		// 		console.log(typeName, 'ìƒì„± í™•ì¸');
		// 		type[typeNum] = new Image();
		// 		type[typeNum].src = './icon/' + typeName + '.png';
		// 		type[typeNum].alt = typeName + (type.length);
		// 		space.append(type[typeNum]);
		// 		type[typeNum].className = typeName;
		// 		console.log(typeName, 'ê°œìˆ˜ >> ', type.length);
		// 		console.log(typeName, 'alt >> ', type[typeNum].alt);
		// 		typeNum++;
		// 	})
		// }

		// creat(cIconBtn, 'icon', icon, iconNum);
		// creat(cFolderBtn, 'folder', folder, folderNum);

		// console.log(icons);

		// let arrIcon = [];
		// for (var i = 0; i < icons.length; i++) {
		// 	arrIcon.push(icons[i]);
		// }

		// arrIcon.forEach(function (c) {
		// 	c.addEventListener('click', function () {
		// 		console.log('í´ë¦­ í™•ì¸')
		// 	})
		// })

		// ëª¨ë‹¬ modal.className = 'modal'; modal_body.className = 'modal_body';
		// modal_body.textContent ='hello :D' close_btn.className = 'close_btn';
		// close_btn.textContent = "X" body.appendChild(modal);
		// modal.appendChild(modal_body); modal_body.appendChild(close_btn);

		// let myDesktop = new Desktop(
		// 	/* TODO: myDesktop ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒì„±ìì˜ ë³€ìˆ˜ë¡œ ë¬´ì—‡ì´ ë“¤ì–´ê°€ì•¼ í• ê¹Œìš”? */
		// );

	</script>
</body>

</html>