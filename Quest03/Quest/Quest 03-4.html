<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>숫자야구 게임</title>

    <style>
        body {
            width: 50%;
            max-width: 800px;
            min-width: 480px;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <h1>숫자야구 게임</h1>

    <li style="margin-bottom:5px;">게임시작을 누르면 랜덤값으로 세자리의 숫자가 지정됩니다.</li>
    <li style="margin-bottom:5px;">랜덤값 세자리에 표시되는 각각의 숫자는 0이 나올 수 없으며 서로 중복값이 있어서는 안됩니다.</li>
    <li style="margin-bottom:5px;">유저는 임의 세자리를 기록해서 맞는지 결과를 확인합니다.</li>
    <li style="margin-bottom:5px;">회별로 기록한 숫자와 설정된숫자를 비교해서 상황을 표현해 줍니다.</li>
    <li style="margin-bottom:5px;">야구게임이니 9회안에 맞추고 실패시 패배입니다.</li>
    <div class="setDigitForm">
        <input type="submit" value="게임시작" class="setDigitSubmit">
    </div>

    <div class="form" style="margin-top:40px;">
        <input type="text" id="guessField" class="guessField">
        <input type="submit" value="정답확인" class="guessSubmit">
    </div>

    <div class="resultArea" style="margin-top:40px;">
        <span>정답여부는 여기에!!</span>
    </div>

    <script>
        //* 버튼 *//
        var set = document.getElementsByClassName('setDigitSubmit')[0]; // 게임시작
        var guess = document.getElementsByClassName('guessSubmit')[0]; // 정답확인

        //* 입력 *//
        var input_arr; // 값 입력

        //* 출력*// 
        var result = document.getElementsByClassName('resultArea')[0]; // 정답여부

        //* 변수 *//
        var list; // 전체 숫자 범위 (1~9)
        var choose = []; // 랜덤 숫자 3개
        var count; // 횟수
        var strike; // 숫자 위치 일치
        var ball; // 숫자 일치


        guess.disabled = true; // 정답 확인 비활성화
        set.addEventListener('click', function () { // 게임시작 클릭
            count = 0; // 초기화
            list = []; // 초기화
            for(var i = 1; i<10;i++){ // 숫자 범위 (1~9)
                list.push(i);
            }
            for (var i = 0; i < 3; i++) { // 숫자 3개 랜덤추출
                var rd = Math.floor(Math.random() * list.length); // 0 ~ 8 중 숫자 하나 뽑기
                console.log("list : " + list) // list 보유 숫자 확인
                console.log((i+1)+"번째 숫자 index >> "+rd)
                choose[i] = list.splice(rd, 1)[0]; // list[rd] 값을 choose에 넣고 list에서는 제거 = splice() // array이기 때문에 [0]로 숫자만 확인가능
                console.log("choose : " + choose[i] ) // 추출된 숫자 확인
            }
            console.log('choose >> ', choose); // 추출된 전체 숫자 확인
            guess.disabled = false; // 정답 확인 활성화
            guess.addEventListener('click', function () { // 정답확인 클릭
                strike = 0; // 초기화
                ball = 0; // 초기화
                count++;
                if(input_arr == undefined){ // 정답확인 버튼 클릭시 input 값이 있으면 출력문 없애는 html
                    result.innerHTML = ""
                }
                var input = document.getElementsByClassName('guessField')[0].value; // 정답입력
                input_arr = input.split(''); // 문자열 분할
                console.log(input_arr) // 분할 확인
                for (var r = 0; r < 3; r++) { // 랜덤 숫자 3개의 인덱스값
                    for (var a = 0; a < 3; a++) { // 입력한 숫자 3개의 인덱스값
                        if (choose[r] == input_arr[a]) { // 숫자 일치
                            if (r === a) { // 위치 일치 O
                                strike++;
                            } else { // 위치 일치 X
                                ball++;
                            }
                        }
                    }
                }
                console.log("strike >> ", strike) // 확인
                console.log("ball >> ", ball) // 확인
                
                if(count < 10){
                    if (strike == 3) {
                        if(count == 1){
                            result.innerHTML += ("<h3>⭐ 홈런 ⭐</h3>");
                            guess.disabled = true; // 정답 확인 비활성화
                        }
                        result.innerHTML += ("<h3>⭕ " + count + "번 만에 맞추셨습니다 ⭕</h3>");
                        guess.disabled = true; // 정답 확인 비활성화
                    } else {
                        result.innerHTML += ("<h3>" + count + "회 : " + strike + "S " + ball + "B ➡ "+input_arr +"</h3>");
                    }
                }else{
                    result.innerHTML += ("<h2>❌ 실패 ❌</h2>");
                    guess.disabled = true; // 정답 확인 비활성화
                }
            })
        })
        </script>
</body>

</html>